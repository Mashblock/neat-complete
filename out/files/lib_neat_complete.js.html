<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib&#x2F;neat_complete.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/NeatComplete.Widget.html">NeatComplete.Widget</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/NeatComplete.html">NeatComplete</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: lib&#x2F;neat_complete.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;&#x2F; Generated by CoffeeScript 1.3.1

&#x2F;**
  * @module NeatComplete
*&#x2F;


(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __slice = [].slice;

  if (window.NeatComplete == null) {
    window.NeatComplete = {};
  }

  &#x2F;**
    * Convinience function for applying events to dom element
    * @method NeatComplete.addDomEvent
    * @param {Element} element input element to apply event
    * @param {String} event_name name of event type
    * @param {Function} callback callback function
  *&#x2F;


  NeatComplete.addDomEvent = function(elem, event, fn) {
    if (elem.attachEvent != null) {
      elem[&quot;e&quot; + event + fn] = fn;
      elem[&quot;&quot; + event + fn] = function() {
        return elem[&quot;e&quot; + event + fn](window.event);
      };
      return elem.attachEvent(&quot;on&quot; + event, elem[&quot;&quot; + event + fn]);
    } else {
      return elem.addEventListener(event, fn, false);
    }
  };

  if (window.NeatComplete == null) {
    window.NeatComplete = {};
  }

  NeatComplete._Result = (function() {

    _Result.name = &#x27;_Result&#x27;;

    function _Result(service, options) {
      var _ref, _ref1, _ref2, _ref3;
      this.service = service;
      this.options = options;
      this.widget = this.service.widget;
      this.renderer = this.service.options.renderer || this.widget.options.renderer;
      this.value = (_ref = this.options) != null ? _ref.value : void 0;
      this.score = ((_ref1 = this.options) != null ? _ref1.score : void 0) || 0;
      this.identifier = (_ref2 = this.options) != null ? _ref2.identifier : void 0;
      this.data = ((_ref3 = this.options) != null ? _ref3.data : void 0) || {};
    }

    _Result.prototype.render = function() {
      this.li = document.createElement(&quot;li&quot;);
      this.li.innerHTML = this.renderer != null ? this.renderer(this.value, this.data) : this.value;
      this.li.setAttribute(&quot;class&quot;, this.widget.item_class);
      this.addEvents();
      return this.li;
    };

    _Result.prototype.addEvents = function() {
      var _this = this;
      NeatComplete.addDomEvent(this.li, &quot;click&quot;, function(e) {
        _this.selectItem();
        if (e.preventDefault) {
          return e.preventDefault();
        } else {
          return e.returnValue = false;
        }
      });
      NeatComplete.addDomEvent(this.li, &quot;mouseover&quot;, function() {
        return _this.highlight();
      });
      NeatComplete.addDomEvent(this.li, &quot;mouseout&quot;, function() {
        return _this.unhighlight();
      });
      NeatComplete.addDomEvent(this.li, &quot;mousedown&quot;, function() {
        return _this.widget.mouseDownOnSelect = true;
      });
      return NeatComplete.addDomEvent(this.li, &quot;mouseup&quot;, function() {
        return _this.widget.mouseDownOnSelect = false;
      });
    };

    _Result.prototype.selectItem = function() {
      return this.widget.selectHighlighted();
    };

    _Result.prototype.highlight = function() {
      var _ref;
      if ((_ref = this.widget.highlighted) != null) {
        _ref.unhighlight();
      }
      this.li.className = &quot;&quot; + this.li.className + &quot; &quot; + this.widget.hover_class;
      return this.widget.highlighted = this;
    };

    _Result.prototype.unhighlight = function() {
      this.widget.highlighted = null;
      return this.li.className = this.li.className.replace(new RegExp(this.widget.hover_class, &quot;gi&quot;), &quot;&quot;);
    };

    return _Result;

  })();

  if (window.NeatComplete == null) {
    window.NeatComplete = {};
  }

  NeatComplete._Service = (function() {

    _Service.name = &#x27;_Service&#x27;;

    function _Service(widget, name, search_fn, options) {
      var _this = this;
      this.widget = widget;
      this.name = name;
      this.search_fn = search_fn;
      this.options = options != null ? options : {};
      this._response = __bind(this._response, this);

      this.results = [];
      this.response = function(q, data) {
        return _this._response.apply(_this, arguments);
      };
    }

    _Service.prototype.search = function(q) {
      this.last_query = q;
      this.ready = false;
      return this.search_fn(q, this.response);
    };

    _Service.prototype._response = function(q, data) {
      var datum, _i, _len;
      this.results = [];
      if (this.last_query === q) {
        this.results = [];
        for (_i = 0, _len = data.length; _i &lt; _len; _i++) {
          datum = data[_i];
          this.results.push(new NeatComplete._Result(this, datum));
        }
        this.ready = true;
        return this.widget.showResults();
      }
    };

    return _Service;

  })();

  &#x2F;**
    * @author Able Technology Ltd.
    * @version 0.0.1
  *&#x2F;


  if (window.NeatComplete == null) {
    window.NeatComplete = {};
  }

  NeatComplete.Widget = (function() {

    Widget.name = &#x27;Widget&#x27;;

    Widget.prototype.max_results = 10;

    Widget.prototype.list_class = &#x27;nc_list&#x27;;

    Widget.prototype.item_class = &#x27;nc_item&#x27;;

    Widget.prototype.hover_class = &#x27;nc_hover&#x27;;

    Widget.prototype.footer_class = &#x27;nc_footer&#x27;;

    Widget.prototype.empty_class = &#x27;nc_empty&#x27;;

    &#x2F;**
      * Constructor for new &#x60;widget&#x60; instance
      *
      * @class NeatComplete.Widget
      * @constructor
      * @param {Node} element input element to apply widget to
      * @param {Object} options
      * @returns {NeatComplete.Widget}
    *&#x2F;


    function Widget(element, options) {
      this.element = element;
      this.options = options != null ? options : {};
      this.element.setAttribute(&#x27;autocomplete&#x27;, &#x27;off&#x27;);
      this.services = [];
      this._addListeners();
      this.output = document.createElement(&quot;ul&quot;);
      this.output.setAttribute(&quot;class&quot;, this.list_class);
      this._applyStyle(&quot;display&quot;, &quot;none&quot;);
      this._applyStyle(&quot;position&quot;, &quot;absolute&quot;);
      document.body.appendChild(this.output);
      this;

    }

    &#x2F;**
      * Method to add a new search service
      * @method addService
      * @param {String} name
      * @param {Function} search_function
    *&#x2F;


    Widget.prototype.addService = function(name, search_function) {
      this.services.push(new NeatComplete._Service(this, name, search_function));
      return this;
    };

    &#x2F;**
      * Setter for options
      * @method setOption
      * @param {String} option_name
      * @param {*} option_value
    *&#x2F;


    Widget.prototype.setOption = function(name, value) {
      this.options[name] = value;
      return this;
    };

    &#x2F;**
      * Getter for options
      * @method getOption
      * @param {String} option_name
    *&#x2F;


    Widget.prototype.getOption = function(name) {
      return this.options[name];
    };

    &#x2F;**
      * Setter for options
    *&#x2F;


    Widget.prototype.on = function(event_name, callback) {
      var _base;
      if (this.subs == null) {
        this.subs = {};
      }
      if ((_base = this.subs)[event_name] == null) {
        _base[event_name] = [];
      }
      this.subs[event_name].push(callback);
      return this;
    };

    &#x2F;**
      * Setter for options
    *&#x2F;


    Widget.prototype.trigger = function() {
      var args, callback, event_name, _i, _len, _ref, _ref1;
      event_name = arguments[0], args = 2 &lt;= arguments.length ? __slice.call(arguments, 1) : [];
      if (((_ref = this.subs) != null ? _ref[event_name] : void 0) != null) {
        _ref1 = this.subs[event_name];
        for (_i = 0, _len = _ref1.length; _i &lt; _len; _i++) {
          callback = _ref1[_i];
          callback.apply(null, args);
        }
      }
      return this;
    };

    &#x2F;*!
      Ignore.
    *&#x2F;


    Widget.prototype._addListeners = function() {
      var _this = this;
      NeatComplete.addDomEvent(this.element, &quot;focus&quot;, function(e) {
        return _this.focused = true;
      });
      NeatComplete.addDomEvent(this.element, &quot;keypress&quot;, function(e) {
        var keyCode, _ref;
        keyCode = e.which || e.keyCode;
        if (keyCode === 13) {
          if ((_ref = _this.highlighted) != null) {
            _ref.selectItem();
          }
          if (e.preventDefault) {
            e.preventDefault();
          } else {
            e.returnValue = false;
          }
          return false;
        }
      });
      NeatComplete.addDomEvent(this.element, &quot;keydown&quot;, function(e) {
        var keyCode, _ref;
        keyCode = e.which || e.keyCode;
        switch (keyCode) {
          case 38:
            _this._moveHighlight(-1);
            return false;
          case 40:
            _this._moveHighlight(1);
            return false;
          case 9:
            return (_ref = _this.highlighted) != null ? _ref.selectItem() : void 0;
          case 27:
            return _this._hideResults();
          case 37:
          case 39:
          case 13:
            break;
          default:
            if (_this._timeout != null) {
              clearTimeout(_this._timeout);
            }
            return _this._timeout = setTimeout(function() {
              return _this._getSuggestions();
            }, 400);
        }
      });
      return NeatComplete.addDomEvent(this.element, &quot;blur&quot;, function(e) {
        if (!_this.mouseDownOnSelect) {
          _this.focused = false;
          return _this._hideResults();
        }
      });
    };

    Widget.prototype._moveHighlight = function(step) {
      var current_index, _ref, _ref1;
      current_index = this.highlighted != null ? this.results.indexOf(this.highlighted) : -1;
      if ((_ref = this.highlighted) != null) {
        _ref.unhighlight();
      }
      current_index += step;
      if (current_index &lt; -1) {
        current_index = this.results.length - 1;
      } else if (current_index &gt;= this.results.length) {
        current_index = -1;
      }
      if ((_ref1 = this.results[current_index]) != null) {
        _ref1.highlight();
      }
      return this.element.value = this.highlighted != null ? this.highlighted.value : this._val;
    };

    Widget.prototype._getSuggestions = function() {
      var service, _i, _len, _ref, _results;
      this._val = this.element.value;
      if (this._val !== &#x27;&#x27;) {
        _ref = this.services;
        _results = [];
        for (_i = 0, _len = _ref.length; _i &lt; _len; _i++) {
          service = _ref[_i];
          _results.push(service.search(this._val));
        }
        return _results;
      } else {
        return this._hideResults();
      }
    };

    Widget.prototype._applyStyle = function(attr, value) {
      return this.output.style[attr] = value;
    };

    Widget.prototype._getPosition = function() {
      var coords, el;
      el = this.element;
      coords = {
        top: el.offsetTop + el.offsetHeight,
        left: el.offsetLeft
      };
      while (el = el.offsetParent) {
        coords.top += el.offsetTop;
        coords.left += el.offsetLeft;
      }
      return coords;
    };

    Widget.prototype._hideResults = function() {
      var service, _i, _len, _ref, _results;
      this._applyStyle(&quot;display&quot;, &quot;none&quot;);
      this.results = [];
      _ref = this.services;
      _results = [];
      for (_i = 0, _len = _ref.length; _i &lt; _len; _i++) {
        service = _ref[_i];
        _results.push(service.results = []);
      }
      return _results;
    };

    Widget.prototype._displayResults = function() {
      var coords;
      coords = this._getPosition();
      this._applyStyle(&quot;left&quot;, &quot;&quot; + coords.left + &quot;px&quot;);
      this._applyStyle(&quot;top&quot;, &quot;&quot; + coords.top + &quot;px&quot;);
      return this._applyStyle(&quot;display&quot;, &quot;block&quot;);
    };

    Widget.prototype._renderItem = function(content, cls) {
      var item;
      item = document.createElement(&quot;li&quot;);
      item.innerHTML = content;
      if (cls != null) {
        item.setAttribute(&quot;class&quot;, cls);
      }
      return item;
    };

    Widget.prototype._renderFooter = function() {
      return this._renderItem(this.options.footerContent, &#x27;nc_footer&#x27;);
    };

    Widget.prototype._renderEmpty = function() {
      return this._renderItem(this.options.emptyContent, &#x27;nc_empty&#x27;);
    };

    Widget.prototype._servicesReady = function() {
      var service, states, _i, _len, _ref;
      states = [];
      _ref = this.services;
      for (_i = 0, _len = _ref.length; _i &lt; _len; _i++) {
        service = _ref[_i];
        states.push(service.ready);
      }
      return states.indexOf(false) &lt; 0;
    };

    Widget.prototype.showResults = function() {
      var result, service, _i, _j, _len, _len1, _ref, _ref1;
      if (this._servicesReady()) {
        this.results = [];
        this.output.innerHTML = &quot;&quot;;
        _ref = this.services;
        for (_i = 0, _len = _ref.length; _i &lt; _len; _i++) {
          service = _ref[_i];
          this.results = this.results.concat(service.results);
        }
        if (this.results.length) {
          this.results = this.results.sort(function(a, b) {
            return b.score - a.score;
          });
          this.results = this.results.slice(0, (this.max_results - 1) + 1 || 9e9);
          _ref1 = this.results;
          for (_j = 0, _len1 = _ref1.length; _j &lt; _len1; _j++) {
            result = _ref1[_j];
            this.output.appendChild(result.render());
          }
          if (this.options.footerContent != null) {
            this.output.appendChild(this._renderFooter());
          }
          this._displayResults();
        } else if (this.options.emptyContent != null) {
          this.output.appendChild(this._renderEmpty());
          this._displayResults();
          this.trigger(&quot;results:empty&quot;);
        } else {
          this._hideResults();
        }
        return this.trigger(&quot;results:update&quot;);
      }
    };

    Widget.prototype.selectHighlighted = function() {
      this.element.value = this.highlighted.value;
      this._hideResults();
      return this.trigger(&quot;result:select&quot;, this.highlighted.value, this.highlighted.data);
    };

    return Widget;

  })();

}).call(this);

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
